<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1-Minute Prompt Challenge</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .min-h-screen { min-height: 100vh; }
        .bg-gradient { background: linear-gradient(135deg, #581c87 0%, #312e81 50%, #1e3a8a 100%); }
        .bg-white { background: white; }
        .bg-gray-50 { background: #f9fafb; }
        .bg-purple-50 { background: #faf5ff; }
        .bg-purple-100 { background: #f3e8ff; }
        .bg-purple-600 { background: #9333ea; }
        .bg-purple-700 { background: #7c22ce; }
        .bg-green-100 { background: #dcfce7; }
        .bg-green-500 { background: #22c55e; }
        .bg-green-600 { background: #16a34a; }
        .bg-green-700 { background: #15803d; }
        .bg-red-50 { background: #fef2f2; }
        .bg-red-100 { background: #fee2e2; }
        .bg-orange-50 { background: #fff7ed; }
        .bg-blue-50 { background: #eff6ff; }
        .bg-gray-400 { background: #9ca3af; }
        .bg-gradient-purple { background: linear-gradient(90deg, #9333ea, #ec4899); }
        .bg-gradient-green { background: linear-gradient(90deg, #22c55e, #10b981); }
        .text-white { color: white; }
        .text-gray-500 { color: #6b7280; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-700 { color: #374151; }
        .text-gray-800 { color: #1f2937; }
        .text-purple-600 { color: #9333ea; }
        .text-purple-700 { color: #7c22ce; }
        .text-purple-800 { color: #6b21a8; }
        .text-green-500 { color: #22c55e; }
        .text-green-600 { color: #16a34a; }
        .text-green-700 { color: #15803d; }
        .text-yellow-500 { color: #eab308; }
        .text-yellow-600 { color: #ca8a04; }
        .text-red-500 { color: #ef4444; }
        .text-red-600 { color: #dc2626; }
        .text-red-700 { color: #b91c1c; }
        .text-orange-700 { color: #c2410c; }
        .text-blue-600 { color: #2563eb; }
        .text-blue-700 { color: #1d4ed8; }
        .text-blue-800 { color: #1e40af; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .flex-shrink-0 { flex-shrink: 0; }
        .flex-1 { flex: 1; }
        .w-full { width: 100%; }
        .w-6 { width: 1.5rem; }
        .h-6 { height: 1.5rem; }
        .h-32 { height: 8rem; }
        .max-w-md { max-width: 28rem; }
        .max-w-lg { max-width: 32rem; }
        .max-w-4xl { max-width: 56rem; }
        .max-h-64 { max-height: 16rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mx-2 { margin-left: 0.5rem; margin-right: 0.5rem; }
        .pt-2 { padding-top: 0.5rem; }
        .rounded { border-radius: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-full { border-radius: 9999px; }
        .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
        .border-2 { border-width: 2px; }
        .border { border-width: 1px; }
        .border-t-2 { border-top-width: 2px; }
        .border-l-4 { border-left-width: 4px; }
        .border-purple-200 { border-color: #e9d5ff; }
        .border-purple-500 { border-color: #a855f7; }
        .border-red-400 { border-color: #f87171; }
        .border-red-500 { border-color: #ef4444; }
        .border-orange-500 { border-color: #f97316; }
        .border-green-500 { border-color: #22c55e; }
        .border-blue-500 { border-color: #3b82f6; }
        .border-gray-300 { border-color: #d1d5db; }
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }
        .text-5xl { font-size: 3rem; }
        .text-6xl { font-size: 3.75rem; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .font-mono { font-family: ui-monospace, monospace; }
        .italic { font-style: italic; }
        .overflow-y-auto { overflow-y: auto; }
        .whitespace-pre-wrap { white-space: pre-wrap; }
        .resize-none { resize: none; }
        .cursor-pointer { cursor: pointer; }
        .transition { transition: all 0.2s; }
        .hover-opacity:hover { opacity: 0.9; }
        .hover-bg-purple:hover { background: #7c22ce; }
        .hover-bg-green:hover { background: #15803d; }
        .hover-bg-purple-200:hover { background: #e9d5ff; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-4 > * + * { margin-top: 1rem; }
        input, textarea {
            font-family: inherit;
            font-size: 1rem;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #a855f7;
        }
        button {
            cursor: pointer;
            font-family: inherit;
            border: none;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .btn-primary {
            background: linear-gradient(90deg, #9333ea, #ec4899);
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 700;
            font-size: 1.125rem;
            transition: all 0.2s;
        }
        .btn-primary:hover:not(:disabled) {
            opacity: 0.9;
        }
        .btn-secondary {
            background: #9333ea;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 700;
            transition: all 0.2s;
        }
        .btn-secondary:hover:not(:disabled) {
            background: #7c22ce;
        }
        .btn-green {
            background: #16a34a;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 700;
            transition: all 0.2s;
        }
        .btn-green:hover:not(:disabled) {
            background: #15803d;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // ============================================================
        // ‚ö†Ô∏è PASTE YOUR ANTHROPIC API KEY BELOW ‚ö†Ô∏è
        // Get your key from: https://console.anthropic.com/settings/keys
        // ============================================================
        const ANTHROPIC_API_KEY = 'YOUR-API-KEY-HERE';
        // ============================================================

        const { useState, useEffect, useRef } = React;

        const TeamPromptChallenge = () => {
            const [language, setLanguage] = useState('en');
            const [teamName, setTeamName] = useState('');
            const [playerName, setPlayerName] = useState('');
            const [userPrompt, setUserPrompt] = useState('');
            const [aiResponse, setAiResponse] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [timeLeft, setTimeLeft] = useState(60);
            const [gameState, setGameState] = useState('setup');
            const [attempts, setAttempts] = useState(0);
            const [showHint, setShowHint] = useState(false);
            const [finalScore, setFinalScore] = useState(0);
            const [scoreBreakdown, setScoreBreakdown] = useState(null);
            const [error, setError] = useState('');
            const [hasSucceeded, setHasSucceeded] = useState(false);
            const timerRef = useRef(null);

            const challenge = {
                en: {
                    badPrompt: "Tell me about dogs",
                    poorResult: "Dogs are mammals that bark and are kept as pets. They come in many breeds.",
                    goal: "Get a comparison of 3 dog breeds suitable for apartment living, with pros and cons for each",
                    targetKeywords: ["breed", "apartment", "pros", "cons", "comparison", "living"],
                    hint: "Be specific about: (1) what you want compared, (2) the context (apartment living), (3) the format (pros/cons), (4) how many breeds"
                },
                fr: {
                    badPrompt: "Parle-moi des chiens",
                    poorResult: "Les chiens sont des mammif√®res qui aboient et sont gard√©s comme animaux de compagnie. Il existe de nombreuses races.",
                    goal: "Obtenir une comparaison de 3 races de chiens adapt√©es √† la vie en appartement, avec avantages et inconv√©nients pour chacune",
                    targetKeywords: ["race", "appartement", "avantage", "inconv√©nient", "comparaison", "vie"],
                    hint: "Soyez pr√©cis sur: (1) ce que vous voulez comparer, (2) le contexte (vie en appartement), (3) le format (avantages/inconv√©nients), (4) combien de races"
                }
            };

            const t = {
                en: {
                    title: "1-Minute Prompt Challenge",
                    subtitle: "Team Competition - Best Score Wins!",
                    teamName: "Team Name",
                    playerName: "Player Name",
                    startGame: "Start Challenge",
                    instructions: "Instructions",
                    rule1: "You'll see a BAD prompt and its poor result",
                    rule2: "Your goal: rewrite the prompt to get a SPECIFIC output",
                    rule3: "You have 60 seconds and unlimited attempts",
                    rule4: "Fewer attempts + faster time = higher score",
                    rule5: "Don't copy the goal - write a real prompt!",
                    ready: "Ready to Begin",
                    badPrompt: "‚ùå Bad Prompt:",
                    poorResult: "üòï Poor Result:",
                    yourGoal: "üéØ Your Goal:",
                    showHint: "Show Hint",
                    hideHint: "Hide Hint",
                    hint: "üí° Hint:",
                    yourPrompt: "Your improved prompt:",
                    submit: "Submit to Claude",
                    submitting: "Claude is thinking...",
                    finish: "Finish & Calculate Score",
                    timeLeft: "Time",
                    attempts: "Attempts",
                    aiResponse: "Claude's Response:",
                    keepTrying: "Keep improving! Try to match the goal better.",
                    success: "‚úì Looking good! You can finish or try for a better response.",
                    antiCheat: "‚ö†Ô∏è Don't copy the goal - write a real prompt!",
                    gameOver: "Challenge Complete!",
                    team: "Team",
                    player: "Player",
                    scoreBreakdown: "Score Breakdown",
                    basePoints: "Base Points",
                    timeBonus: "Time Bonus",
                    qualityBonus: "Quality Bonus",
                    attemptPenalty: "Attempt Penalty",
                    totalScore: "TOTAL SCORE",
                    playAgain: "Play Again",
                    submittedPrompt: "Your Winning Prompt:",
                    enterBothNames: "Please enter both team and player names",
                    connectionError: "Connection error. Please try again.",
                    apiKeyMissing: "‚ö†Ô∏è API key not configured. Please add your Anthropic API key."
                },
                fr: {
                    title: "D√©fi Prompt 1 Minute",
                    subtitle: "Comp√©tition d'√âquipe - Le Meilleur Score Gagne!",
                    teamName: "Nom de l'√âquipe",
                    playerName: "Nom du Joueur",
                    startGame: "Commencer le D√©fi",
                    instructions: "Instructions",
                    rule1: "Vous verrez un MAUVAIS prompt et son r√©sultat m√©diocre",
                    rule2: "Votre but: r√©√©crire le prompt pour obtenir un r√©sultat SP√âCIFIQUE",
                    rule3: "Vous avez 60 secondes et des tentatives illimit√©es",
                    rule4: "Moins de tentatives + temps rapide = meilleur score",
                    rule5: "Ne copiez pas l'objectif - √©crivez un vrai prompt!",
                    ready: "Pr√™t √† Commencer",
                    badPrompt: "‚ùå Mauvais Prompt:",
                    poorResult: "üòï R√©sultat M√©diocre:",
                    yourGoal: "üéØ Votre Objectif:",
                    showHint: "Voir l'Indice",
                    hideHint: "Cacher l'Indice",
                    hint: "üí° Indice:",
                    yourPrompt: "Votre prompt am√©lior√©:",
                    submit: "Soumettre √† Claude",
                    submitting: "Claude r√©fl√©chit...",
                    finish: "Terminer & Calculer le Score",
                    timeLeft: "Temps",
                    attempts: "Tentatives",
                    aiResponse: "R√©ponse de Claude:",
                    keepTrying: "Continuez! Essayez de mieux correspondre √† l'objectif.",
                    success: "‚úì √áa a l'air bien! Vous pouvez terminer ou essayer d'am√©liorer.",
                    antiCheat: "‚ö†Ô∏è Ne copiez pas l'objectif - √©crivez un vrai prompt!",
                    gameOver: "D√©fi Termin√©!",
                    team: "√âquipe",
                    player: "Joueur",
                    scoreBreakdown: "D√©tail du Score",
                    basePoints: "Points de Base",
                    timeBonus: "Bonus Temps",
                    qualityBonus: "Bonus Qualit√©",
                    attemptPenalty: "P√©nalit√© Tentatives",
                    totalScore: "SCORE TOTAL",
                    playAgain: "Rejouer",
                    submittedPrompt: "Votre Prompt Gagnant:",
                    enterBothNames: "Veuillez entrer les noms de l'√©quipe et du joueur",
                    connectionError: "Erreur de connexion. Veuillez r√©essayer.",
                    apiKeyMissing: "‚ö†Ô∏è Cl√© API non configur√©e. Veuillez ajouter votre cl√© API Anthropic."
                }
            };

            const texts = t[language];
            const currentChallenge = challenge[language];

            // Timer
            useEffect(() => {
                if (gameState === 'playing' && timeLeft > 0) {
                    timerRef.current = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
                    return () => clearTimeout(timerRef.current);
                } else if (timeLeft === 0 && gameState === 'playing') {
                    finishGame();
                }
            }, [timeLeft, gameState]);

            const startInstructions = () => {
                if (!teamName.trim() || !playerName.trim()) {
                    setError(texts.enterBothNames);
                    return;
                }
                if (!ANTHROPIC_API_KEY || ANTHROPIC_API_KEY === 'YOUR-API-KEY-HERE') {
                    setError(texts.apiKeyMissing);
                    return;
                }
                setError('');
                setGameState('instructions');
            };

            const startPlaying = () => {
                setGameState('playing');
                setTimeLeft(60);
            };

            const checkAntiCheat = (prompt) => {
                const goal = currentChallenge.goal.toLowerCase();
                const userInput = prompt.toLowerCase();
                const goalWords = goal.split(' ').filter(w => w.length > 4);
                const matchCount = goalWords.filter(w => userInput.includes(w)).length;
                return matchCount / goalWords.length > 0.6;
            };

            const evaluateResponse = (response) => {
                const responseLower = response.toLowerCase();
                const keywords = currentChallenge.targetKeywords;
                const matched = keywords.filter(kw => responseLower.includes(kw.toLowerCase()));
                const ratio = matched.length / keywords.length;
                
                if (ratio >= 0.8) return { quality: 'excellent', bonus: 20 };
                if (ratio >= 0.6) return { quality: 'good', bonus: 10 };
                if (ratio >= 0.4) return { quality: 'okay', bonus: 5 };
                return { quality: 'poor', bonus: 0 };
            };

            const submitPrompt = async () => {
                if (!userPrompt.trim() || isLoading) return;

                const isCopied = checkAntiCheat(userPrompt);
                if (isCopied) {
                    setError(texts.antiCheat);
                    return;
                }

                setIsLoading(true);
                setError('');
                setAttempts(prev => prev + 1);

                try {
                    const response = await fetch("https://api.anthropic.com/v1/messages", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "x-api-key": ANTHROPIC_API_KEY,
                            "anthropic-version": "2023-06-01",
                            "anthropic-dangerous-direct-browser-access": "true"
                        },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-5-20250929",
                            max_tokens: 1024,
                            messages: [
                                { role: "user", content: userPrompt }
                            ]
                        })
                    });

                    const data = await response.json();

                    if (data.error) {
                        setError(data.error.message || "API Error");
                        setIsLoading(false);
                        return;
                    }

                    const aiText = data.content
                        .map(item => (item.type === "text" ? item.text : ""))
                        .filter(Boolean)
                        .join("\n");

                    setAiResponse(aiText);

                    const evaluation = evaluateResponse(aiText);
                    if (evaluation.quality === 'excellent' || evaluation.quality === 'good') {
                        setHasSucceeded(true);
                    }
                } catch (err) {
                    setError(texts.connectionError);
                    console.error(err);
                }

                setIsLoading(false);
            };

            const finishGame = () => {
                clearTimeout(timerRef.current);
                
                const basePoints = 50;
                const timeBonus = timeLeft;
                
                let qualityBonus = 0;
                if (aiResponse) {
                    const evaluation = evaluateResponse(aiResponse);
                    qualityBonus = evaluation.bonus;
                }
                
                const attemptPenalty = Math.max(0, (attempts - 1) * 5);
                const total = Math.max(0, basePoints + timeBonus + qualityBonus - attemptPenalty);

                setScoreBreakdown({
                    base: basePoints,
                    time: timeBonus,
                    quality: qualityBonus,
                    attemptPen: attemptPenalty,
                    total: total
                });
                setFinalScore(total);
                setGameState('finished');
            };

            const restartGame = () => {
                setTeamName('');
                setPlayerName('');
                setUserPrompt('');
                setAiResponse('');
                setTimeLeft(60);
                setAttempts(0);
                setShowHint(false);
                setFinalScore(0);
                setScoreBreakdown(null);
                setError('');
                setHasSucceeded(false);
                setGameState('setup');
            };

            const getTimerColor = () => {
                if (timeLeft > 30) return 'text-green-500';
                if (timeLeft > 10) return 'text-yellow-500';
                return 'text-red-500';
            };

            // Setup Screen
            if (gameState === 'setup') {
                return (
                    <div className="min-h-screen bg-gradient flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <h1 className="text-3xl font-bold text-purple-800 mb-2">{texts.title}</h1>
                                <p className="text-purple-600">{texts.subtitle}</p>
                            </div>

                            <div className="flex justify-center mb-6">
                                <button
                                    onClick={() => setLanguage(language === 'en' ? 'fr' : 'en')}
                                    className="flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover-bg-purple-200 transition"
                                >
                                    üåê {language === 'en' ? 'Fran√ßais' : 'English'}
                                </button>
                            </div>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-gray-700 font-medium mb-1">{texts.teamName}</label>
                                    <input
                                        type="text"
                                        value={teamName}
                                        onChange={(e) => setTeamName(e.target.value)}
                                        className="w-full px-4 py-3 border-2 border-purple-200 rounded-lg"
                                        placeholder={language === 'en' ? "Enter team name..." : "Entrez le nom de l'√©quipe..."}
                                    />
                                </div>
                                <div>
                                    <label className="block text-gray-700 font-medium mb-1">{texts.playerName}</label>
                                    <input
                                        type="text"
                                        value={playerName}
                                        onChange={(e) => setPlayerName(e.target.value)}
                                        className="w-full px-4 py-3 border-2 border-purple-200 rounded-lg"
                                        placeholder={language === 'en' ? "Enter player name..." : "Entrez le nom du joueur..."}
                                    />
                                </div>
                            </div>

                            {error && (
                                <p className="mt-4 text-red-500 text-center">{error}</p>
                            )}

                            <button
                                onClick={startInstructions}
                                className="w-full mt-6 btn-primary"
                            >
                                {texts.startGame}
                            </button>
                        </div>
                    </div>
                );
            }

            // Instructions Screen
            if (gameState === 'instructions') {
                return (
                    <div className="min-h-screen bg-gradient flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full">
                            <h2 className="text-2xl font-bold text-purple-800 mb-6 text-center">{texts.instructions}</h2>
                            
                            <div className="space-y-3 mb-8">
                                {[texts.rule1, texts.rule2, texts.rule3, texts.rule4, texts.rule5].map((rule, i) => (
                                    <div key={i} className="flex items-start gap-3">
                                        <span className="bg-purple-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0">
                                            {i + 1}
                                        </span>
                                        <p className="text-gray-700">{rule}</p>
                                    </div>
                                ))}
                            </div>

                            <div className="bg-purple-50 rounded-lg p-4 mb-6 text-center">
                                <p className="text-purple-800 font-medium">{texts.team}: {teamName}</p>
                                <p className="text-purple-600">{texts.player}: {playerName}</p>
                            </div>

                            <button
                                onClick={startPlaying}
                                className="w-full bg-green-600 hover-bg-green text-white py-4 rounded-xl font-bold text-lg transition"
                            >
                                {texts.ready} ‚Üí
                            </button>
                        </div>
                    </div>
                );
            }

            // Playing Screen
            if (gameState === 'playing') {
                return (
                    <div className="min-h-screen bg-gradient p-4">
                        <div className="max-w-4xl mx-auto">
                            {/* Header */}
                            <div className="bg-white rounded-xl p-4 mb-4 flex justify-between items-center">
                                <div>
                                    <span className="font-bold text-purple-800">{teamName}</span>
                                    <span className="text-gray-500 mx-2">‚Ä¢</span>
                                    <span className="text-gray-600">{playerName}</span>
                                </div>
                                <div className={`text-4xl font-mono font-bold ${getTimerColor()}`}>
                                    {timeLeft}s
                                </div>
                                <div className="text-gray-600">
                                    {texts.attempts}: <span className="font-bold">{attempts}</span>
                                </div>
                            </div>

                            {/* Challenge Card */}
                            <div className="bg-white rounded-xl p-6 mb-4 space-y-4">
                                <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                    <p className="font-bold text-red-700">{texts.badPrompt}</p>
                                    <p className="text-gray-700 italic mt-1">"{currentChallenge.badPrompt}"</p>
                                </div>

                                <div className="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                                    <p className="font-bold text-orange-700">{texts.poorResult}</p>
                                    <p className="text-gray-700 mt-1">{currentChallenge.poorResult}</p>
                                </div>

                                <div className="bg-green-100 border-l-4 border-green-500 p-4 rounded">
                                    <p className="font-bold text-green-700">{texts.yourGoal}</p>
                                    <p className="text-gray-800 font-medium mt-1">{currentChallenge.goal}</p>
                                </div>

                                <button
                                    onClick={() => setShowHint(!showHint)}
                                    className="text-blue-600 font-medium cursor-pointer"
                                >
                                    {showHint ? texts.hideHint : texts.showHint}
                                </button>

                                {showHint && (
                                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                        <p className="font-bold text-blue-700">{texts.hint}</p>
                                        <p className="text-gray-700 mt-1">{currentChallenge.hint}</p>
                                    </div>
                                )}
                            </div>

                            {/* Input Area */}
                            <div className="bg-white rounded-xl p-6 mb-4">
                                <label className="block font-bold text-purple-800 mb-2">{texts.yourPrompt}</label>
                                <textarea
                                    value={userPrompt}
                                    onChange={(e) => setUserPrompt(e.target.value)}
                                    className="w-full h-32 p-4 border-2 border-purple-200 rounded-lg resize-none"
                                    placeholder={language === 'en' ? "Write your improved prompt here..." : "√âcrivez votre prompt am√©lior√© ici..."}
                                    disabled={isLoading}
                                />

                                {error && (
                                    <div className="mt-2 p-3 bg-red-100 border border-red-400 rounded-lg text-red-700">
                                        {error}
                                    </div>
                                )}

                                <div className="flex gap-4 mt-4">
                                    <button
                                        onClick={submitPrompt}
                                        disabled={isLoading || !userPrompt.trim()}
                                        className="flex-1 btn-secondary"
                                    >
                                        {isLoading ? texts.submitting : texts.submit}
                                    </button>
                                    <button
                                        onClick={finishGame}
                                        disabled={attempts === 0}
                                        className="px-6 btn-green"
                                    >
                                        {texts.finish}
                                    </button>
                                </div>
                            </div>

                            {/* AI Response */}
                            {aiResponse && (
                                <div className="bg-white rounded-xl p-6">
                                    <p className="font-bold text-purple-800 mb-2">{texts.aiResponse}</p>
                                    <div className="bg-gray-50 rounded-lg p-4 max-h-64 overflow-y-auto whitespace-pre-wrap text-gray-700">
                                        {aiResponse}
                                    </div>
                                    <p className={`mt-3 font-medium ${hasSucceeded ? 'text-green-600' : 'text-yellow-600'}`}>
                                        {hasSucceeded ? texts.success : texts.keepTrying}
                                    </p>
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            // Finished Screen
            if (gameState === 'finished') {
                return (
                    <div className="min-h-screen bg-gradient flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
                            <div className="text-6xl mb-4">üèÜ</div>
                            <h2 className="text-2xl font-bold text-purple-800 mb-2">{texts.gameOver}</h2>
                            
                            <div className="bg-purple-50 rounded-lg p-4 mb-6">
                                <p className="text-purple-800 font-medium">{texts.team}: {teamName}</p>
                                <p className="text-purple-600">{texts.player}: {playerName}</p>
                            </div>

                            <div className="text-6xl font-bold text-purple-600 mb-6">
                                {finalScore}
                            </div>

                            {scoreBreakdown && (
                                <div className="bg-gray-50 rounded-lg p-4 mb-6 text-left">
                                    <h3 className="font-bold text-gray-800 mb-3 text-center">{texts.scoreBreakdown}</h3>
                                    <div className="space-y-2 text-sm">
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">{texts.basePoints}</span>
                                            <span className="font-medium">+{scoreBreakdown.base}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">{texts.timeBonus} ({scoreBreakdown.time}s)</span>
                                            <span className="font-medium text-green-600">+{scoreBreakdown.time}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">{texts.qualityBonus}</span>
                                            <span className="font-medium text-blue-600">+{scoreBreakdown.quality}</span>
                                        </div>
                                        {scoreBreakdown.attemptPen > 0 && (
                                            <div className="flex justify-between">
                                                <span className="text-gray-600">{texts.attemptPenalty}</span>
                                                <span className="font-medium text-red-600">-{scoreBreakdown.attemptPen}</span>
                                            </div>
                                        )}
                                        <div className="border-t-2 border-gray-300 pt-2 mt-2 flex justify-between text-lg">
                                            <span className="font-bold">{texts.totalScore}</span>
                                            <span className="font-bold text-purple-600">{scoreBreakdown.total}</span>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {userPrompt && (
                                <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded text-left mb-6">
                                    <p className="text-sm font-bold text-blue-700 mb-1">{texts.submittedPrompt}</p>
                                    <p className="text-gray-700 italic">"{userPrompt}"</p>
                                </div>
                            )}

                            <button
                                onClick={restartGame}
                                className="w-full btn-primary"
                            >
                                {texts.playAgain}
                            </button>
                        </div>
                    </div>
                );
            }

            return null;
        };

        ReactDOM.render(<TeamPromptChallenge />, document.getElementById('root'));
    </script>
</body>
</html>
