<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Repair Challenge</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // ‚ö†Ô∏è REPLACE THIS WITH YOUR ANTHROPIC API KEY
        const ANTHROPIC_API_KEY = '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';
        
        const { useState, useEffect } = React;
        
        // Lucide React icons as inline SVGs
        const Clock = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );
        
        const Award = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="8" r="7"></circle>
                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
            </svg>
        );
        
        const RefreshCw = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );
        
        const Languages = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m5 8 6 6"></path>
                <path d="m4 14 6-6 2-3"></path>
                <path d="M2 5h12"></path>
                <path d="M7 2h1"></path>
                <path d="m22 22-5-10-5 10"></path>
                <path d="M14 18h6"></path>
            </svg>
        );

        const PromptRepairGame = () => {
            const [language, setLanguage] = useState('en');
            const [currentChallenge, setCurrentChallenge] = useState(0);
            const [userPrompt, setUserPrompt] = useState('');
            const [aiResponse, setAiResponse] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [timeLeft, setTimeLeft] = useState(60);
            const [gameState, setGameState] = useState('instructions');
            const [score, setScore] = useState(0);
            const [attempts, setAttempts] = useState(0);
            const [showHint, setShowHint] = useState(false);
            const [showInstructionsModal, setShowInstructionsModal] = useState(false);

            const challenges = {
                en: [
                    {
                        badPrompt: "Tell me about dogs",
                        poorResult: "Dogs are mammals that bark and are kept as pets. They come in many breeds.",
                        goal: "Get a comparison of 3 dog breeds suitable for apartment living, with pros and cons for each",
                        targetKeywords: ["breed", "apartment", "pros", "cons", "comparison"],
                        hint: "Be specific about what you want compared, the context (apartment living), and the format (pros/cons)"
                    },
                    {
                        badPrompt: "Write something about climate",
                        poorResult: "Climate refers to long-term weather patterns in a region.",
                        goal: "Get a 100-word explanation of climate change for a 10-year-old, using a simple analogy",
                        targetKeywords: ["climate change", "10-year-old", "simple", "analogy", "explain"],
                        hint: "Specify the audience age, desired length, and request an analogy to make it relatable"
                    },
                    {
                        badPrompt: "Help with Python",
                        poorResult: "Python is a programming language. What do you need help with?",
                        goal: "Get a working Python function that removes duplicates from a list, with code comments explaining each step",
                        targetKeywords: ["function", "remove duplicates", "list", "comments", "code"],
                        hint: "Describe the exact task (function to remove duplicates), input/output, and ask for commented code"
                    },
                    {
                        badPrompt: "Give me a recipe",
                        poorResult: "Here's a recipe for chocolate chip cookies: Mix flour, sugar, butter, eggs, and chocolate chips. Bake at 350¬∞F.",
                        goal: "Get a detailed recipe for vegetarian pasta that takes under 30 minutes, serves 4, and includes nutritional information",
                        targetKeywords: ["vegetarian", "pasta", "30 minutes", "serves 4", "nutritional"],
                        hint: "Specify dietary restrictions, dish type, time constraint, servings, and additional information needed"
                    },
                    {
                        badPrompt: "Explain AI",
                        poorResult: "AI stands for Artificial Intelligence. It's when computers can think.",
                        goal: "Get a 3-paragraph explanation of how neural networks work, using the analogy of how the human brain learns",
                        targetKeywords: ["neural network", "paragraph", "analogy", "brain", "learn"],
                        hint: "Specify the AI concept (neural networks), structure (3 paragraphs), and request a brain-learning analogy"
                    }
                ],
                fr: [
                    {
                        badPrompt: "Parle-moi des chiens",
                        poorResult: "Les chiens sont des mammif√®res qui aboient et sont gard√©s comme animaux de compagnie. Il existe de nombreuses races.",
                        goal: "Obtenir une comparaison de 3 races de chiens adapt√©es √† la vie en appartement, avec avantages et inconv√©nients pour chacune",
                        targetKeywords: ["race", "appartement", "avantages", "inconv√©nients", "comparaison"],
                        hint: "Soyez pr√©cis sur ce que vous voulez comparer, le contexte (vie en appartement) et le format (avantages/inconv√©nients)"
                    },
                    {
                        badPrompt: "√âcris quelque chose sur le climat",
                        poorResult: "Le climat fait r√©f√©rence aux conditions m√©t√©orologiques √† long terme dans une r√©gion.",
                        goal: "Obtenir une explication de 100 mots sur le changement climatique pour un enfant de 10 ans, en utilisant une analogie simple",
                        targetKeywords: ["changement climatique", "10 ans", "simple", "analogie", "expliquer"],
                        hint: "Pr√©cisez l'√¢ge du public, la longueur souhait√©e et demandez une analogie pour la rendre accessible"
                    },
                    {
                        badPrompt: "Aide avec Python",
                        poorResult: "Python est un langage de programmation. De quoi avez-vous besoin?",
                        goal: "Obtenir une fonction Python fonctionnelle qui supprime les doublons d'une liste, avec des commentaires expliquant chaque √©tape",
                        targetKeywords: ["fonction", "supprimer doublons", "liste", "commentaires", "code"],
                        hint: "D√©crivez la t√¢che exacte (fonction pour supprimer les doublons), entr√©e/sortie, et demandez du code comment√©"
                    },
                    {
                        badPrompt: "Donne-moi une recette",
                        poorResult: "Voici une recette de cookies: M√©langez farine, sucre, beurre, ≈ìufs et p√©pites de chocolat. Cuire √† 180¬∞C.",
                        goal: "Obtenir une recette d√©taill√©e de p√¢tes v√©g√©tariennes en moins de 30 minutes, pour 4 personnes, avec informations nutritionnelles",
                        targetKeywords: ["v√©g√©tarien", "p√¢tes", "30 minutes", "4 personnes", "nutritionnel"],
                        hint: "Pr√©cisez les restrictions alimentaires, le type de plat, la contrainte de temps, le nombre de portions et les informations suppl√©mentaires"
                    },
                    {
                        badPrompt: "Explique l'IA",
                        poorResult: "IA signifie Intelligence Artificielle. C'est quand les ordinateurs peuvent penser.",
                        goal: "Obtenir une explication en 3 paragraphes du fonctionnement des r√©seaux neuronaux, en utilisant l'analogie de l'apprentissage du cerveau humain",
                        targetKeywords: ["r√©seau neuronal", "paragraphe", "analogie", "cerveau", "apprentissage"],
                        hint: "Pr√©cisez le concept d'IA (r√©seaux neuronaux), la structure (3 paragraphes) et demandez une analogie avec l'apprentissage du cerveau"
                    }
                ]
            };

            const translations = {
                en: {
                    title: "Prompt Repair Challenge",
                    subtitle: "Master the art of prompt engineering in 60 seconds!",
                    howToPlay: "How to Play",
                    instructions: [
                        "You'll see a BAD PROMPT that produces a poor result from AI",
                        "Your GOAL is described - what you actually want the AI to produce",
                        "REWRITE the prompt to be clear, specific, and effective",
                        "Click 'Test My Prompt' to see if Claude gives you the desired result",
                        "You have 60 seconds per challenge. Fewer attempts = higher score!"
                    ],
                    whatYouLearn: "What You'll Learn:",
                    learningPoints: [
                        "How to be specific and clear in your requests",
                        "Adding context and constraints to prompts",
                        "Specifying output format and structure",
                        "Targeting appropriate audience levels"
                    ],
                    warningTitle: "‚ö†Ô∏è Important Rule:",
                    warningText: "DO NOT copy-paste the goal! You must write an actual prompt (a request/instruction to Claude). Copying the goal will result in a 5-point penalty.",
                    startGame: "Start Game",
                    backToGame: "Back to Game",
                    badPromptLabel: "‚ùå Bad Prompt:",
                    poorResultLabel: "üìâ Poor Result:",
                    yourGoalLabel: "üéØ Your Goal:",
                    yourPromptLabel: "Your Improved Prompt:",
                    promptPlaceholder: "Write your improved prompt here...",
                    submitButton: "Test My Prompt",
                    testing: "Testing...",
                    hintButton: "üí° Need a Hint?",
                    hint: "Hint:",
                    timeRemaining: "Time Remaining:",
                    challenge: "Challenge",
                    of: "of",
                    score: "Score:",
                    attempts: "Attempts:",
                    success: "üéâ Success!",
                    successMessage: "Great prompt engineering! Your prompt successfully achieved the goal.",
                    nextChallenge: "Next Challenge",
                    timeUp: "‚è∞ Time's Up!",
                    timeUpMessage: "Don't worry! Prompt engineering takes practice.",
                    tryAgain: "Try Again",
                    finalScore: "Final Score",
                    restart: "Restart Game",
                    aiResponse: "ü§ñ Claude's Response:",
                    showInstructions: "üìñ Instructions",
                    penaltyWarning: "‚ö†Ô∏è COPY-PASTE DETECTED! -5 points penalty. Write an actual prompt like 'Can you...' or 'Please create...'"
                },
                fr: {
                    title: "D√©fi de R√©paration de Prompt",
                    subtitle: "Ma√Ætrisez l'art de l'ing√©nierie de prompts en 60 secondes!",
                    howToPlay: "Comment Jouer",
                    instructions: [
                        "Vous verrez un MAUVAIS PROMPT qui produit un r√©sultat m√©diocre de l'IA",
                        "Votre OBJECTIF est d√©crit - ce que vous voulez r√©ellement que l'IA produise",
                        "R√â√âCRIVEZ le prompt pour qu'il soit clair, pr√©cis et efficace",
                        "Cliquez sur 'Tester Mon Prompt' pour voir si Claude donne le r√©sultat souhait√©",
                        "Vous avez 60 secondes par d√©fi. Moins de tentatives = score plus √©lev√©!"
                    ],
                    whatYouLearn: "Ce Que Vous Apprendrez:",
                    learningPoints: [
                        "Comment √™tre pr√©cis et clair dans vos demandes",
                        "Ajouter du contexte et des contraintes aux prompts",
                        "Sp√©cifier le format et la structure de sortie",
                        "Cibler les niveaux d'audience appropri√©s"
                    ],
                    warningTitle: "‚ö†Ô∏è R√®gle Importante:",
                    warningText: "NE copiez-collez PAS l'objectif! Vous devez √©crire un vrai prompt (une demande/instruction √† Claude). Copier l'objectif entra√Ænera une p√©nalit√© de 5 points.",
                    startGame: "Commencer le Jeu",
                    backToGame: "Retour au Jeu",
                    badPromptLabel: "‚ùå Mauvais Prompt:",
                    poorResultLabel: "üìâ R√©sultat M√©diocre:",
                    yourGoalLabel: "üéØ Votre Objectif:",
                    yourPromptLabel: "Votre Prompt Am√©lior√©:",
                    promptPlaceholder: "√âcrivez votre prompt am√©lior√© ici...",
                    submitButton: "Tester Mon Prompt",
                    testing: "Test en cours...",
                    hintButton: "üí° Besoin d'un Indice?",
                    hint: "Indice:",
                    timeRemaining: "Temps Restant:",
                    challenge: "D√©fi",
                    of: "de",
                    score: "Score:",
                    attempts: "Tentatives:",
                    success: "üéâ R√©ussite!",
                    successMessage: "Excellente ing√©nierie de prompt! Votre prompt a atteint l'objectif avec succ√®s.",
                    nextChallenge: "D√©fi Suivant",
                    timeUp: "‚è∞ Temps √âcoul√©!",
                    timeUpMessage: "Ne vous inqui√©tez pas! L'ing√©nierie de prompts demande de la pratique.",
                    tryAgain: "R√©essayer",
                    finalScore: "Score Final",
                    restart: "Recommencer",
                    aiResponse: "ü§ñ R√©ponse de Claude:",
                    showInstructions: "üìñ Instructions",
                    penaltyWarning: "‚ö†Ô∏è COPIER-COLLER D√âTECT√â! P√©nalit√© de -5 points. √âcrivez un vrai prompt comme 'Peux-tu...' ou 'Cr√©e-moi...'"
                }
            };

            const t = translations[language];
            const currentChallenges = challenges[language];
            const challenge = currentChallenges[currentChallenge];

            useEffect(() => {
                if (timeLeft > 0 && gameState === 'playing') {
                    const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
                    return () => clearTimeout(timer);
                } else if (timeLeft === 0 && gameState === 'playing') {
                    setGameState('timeup');
                }
            }, [timeLeft, gameState]);

            const calculateSimilarity = (str1, str2) => {
                const s1 = str1.toLowerCase().replace(/[^a-z0-9]/g, '');
                const s2 = str2.toLowerCase().replace(/[^a-z0-9]/g, '');
                
                if (s2.includes(s1) || s1.includes(s2)) return 1;
                
                const words1 = str1.toLowerCase().split(/\s+/);
                const words2 = str2.toLowerCase().split(/\s+/);
                const commonWords = words1.filter(word => words2.includes(word) && word.length > 3);
                
                return commonWords.length / Math.max(words1.length, words2.length);
            };

            const evaluateResponse = (response, keywords) => {
                const lowerResponse = response.toLowerCase();
                
                if (response.length < 100) return false;
                
                const matchedKeywords = keywords.filter(keyword => {
                    const keywordLower = keyword.toLowerCase();
                    return lowerResponse.includes(keywordLower) || 
                           lowerResponse.includes(keywordLower.slice(0, -1)) ||
                           (keywordLower.includes(' ') && keywordLower.split(' ').some(word => lowerResponse.includes(word)));
                });
                
                return matchedKeywords.length >= Math.ceil(keywords.length * 0.4);
            };

            const testPrompt = async () => {
                if (!userPrompt.trim() || isLoading) return;
                
                setIsLoading(true);
                setAttempts(attempts + 1);
                
                const similarity = calculateSimilarity(userPrompt, challenge.goal);
                
                if (similarity > 0.7) {
                    setScore(Math.max(0, score - 5));
                    setAiResponse(t.penaltyWarning);
                    setIsLoading(false);
                    return;
                }
                
                if (userPrompt.length < 20) {
                    setAiResponse(language === 'fr'
                        ? "‚ö†Ô∏è Votre prompt est trop court. Soyez plus sp√©cifique et d√©taill√©!"
                        : "‚ö†Ô∏è Your prompt is too short. Be more specific and detailed!");
                    setIsLoading(false);
                    return;
                }
                
                try {
                    const response = await fetch("https://api.anthropic.com/v1/messages", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "x-api-key": ANTHROPIC_API_KEY,
                            "anthropic-version": "2023-06-01"
                        },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-20250514",
                            max_tokens: 1000,
                            messages: [
                                { 
                                    role: "user", 
                                    content: language === 'fr' 
                                        ? `R√©ponds en fran√ßais: ${userPrompt}`
                                        : userPrompt 
                                }
                            ],
                        })
                    });

                    const data = await response.json();
                    const responseText = data.content
                        .filter(item => item.type === "text")
                        .map(item => item.text)
                        .join("\n");
                    
                    setAiResponse(responseText);
                    
                    const isSuccess = evaluateResponse(responseText, challenge.targetKeywords);
                    
                    let pointsEarned;
                    if (isSuccess) {
                        pointsEarned = Math.max(10 - attempts, 3);
                        setScore(score + pointsEarned);
                    } else {
                        pointsEarned = Math.max(5 - attempts, 1);
                        setScore(score + pointsEarned);
                    }
                    
                    setGameState('success');
                    
                } catch (error) {
                    setAiResponse(language === 'fr' 
                        ? "Erreur lors de l'appel √† l'API. Veuillez r√©essayer."
                        : "Error calling API. Please try again.");
                }
                
                setIsLoading(false);
            };

            const nextChallenge = () => {
                if (currentChallenge < currentChallenges.length - 1) {
                    setCurrentChallenge(currentChallenge + 1);
                    setUserPrompt('');
                    setAiResponse('');
                    setGameState('playing');
                    setTimeLeft(60);
                    setAttempts(0);
                    setShowHint(false);
                } else {
                    setGameState('finished');
                }
            };

            const restartGame = () => {
                setCurrentChallenge(0);
                setUserPrompt('');
                setAiResponse('');
                setGameState('instructions');
                setTimeLeft(60);
                setScore(0);
                setAttempts(0);
                setShowHint(false);
                setShowInstructionsModal(false);
            };

            const startGame = () => {
                setGameState('playing');
            };

            if (gameState === 'finished') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-cyan-600 p-8 flex items-center justify-center">
                        <div className="max-w-2xl w-full bg-white rounded-2xl shadow-2xl p-8 text-center">
                            <Award className="w-20 h-20 text-yellow-500 mx-auto mb-4" />
                            <h2 className="text-4xl font-bold text-gray-800 mb-4">{t.finalScore}</h2>
                            <p className="text-6xl font-bold text-purple-600 mb-8">{score}</p>
                            <button
                                onClick={restartGame}
                                className="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:scale-105 transition-transform flex items-center gap-2 mx-auto"
                            >
                                <RefreshCw className="w-5 h-5" />
                                {t.restart}
                            </button>
                        </div>
                    </div>
                );
            }

            if (gameState === 'instructions') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-cyan-600 p-4 md:p-8 flex items-center justify-center">
                        <div className="max-w-3xl w-full bg-white rounded-2xl shadow-2xl p-8 md:p-12">
                            <div className="flex justify-end mb-4">
                                <button
                                    onClick={() => setLanguage(language === 'en' ? 'fr' : 'en')}
                                    className="bg-purple-100 text-purple-700 px-4 py-2 rounded-lg hover:bg-purple-200 transition-colors flex items-center gap-2"
                                >
                                    <Languages className="w-5 h-5" />
                                    {language === 'en' ? 'FR' : 'EN'}
                                </button>
                            </div>
                            
                            <div className="text-center mb-8">
                                <h1 className="text-4xl md:text-5xl font-bold text-gray-800 mb-3">{t.title}</h1>
                                <p className="text-xl text-gray-600">{t.subtitle}</p>
                            </div>

                            <div className="space-y-6 mb-8">
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <span className="text-3xl">üéÆ</span> {t.howToPlay}
                                    </h2>
                                    <ol className="space-y-3">
                                        {t.instructions.map((instruction, index) => (
                                            <li key={index} className="flex gap-3">
                                                <span className="flex-shrink-0 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold">
                                                    {index + 1}
                                                </span>
                                                <span className="text-gray-700 pt-1">{instruction}</span>
                                            </li>
                                        ))}
                                    </ol>
                                </div>

                                <div className="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg">
                                    <h3 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                                        <span className="text-2xl">üí°</span> {t.whatYouLearn}
                                    </h3>
                                    <ul className="space-y-2">
                                        {t.learningPoints.map((point, index) => (
                                            <li key={index} className="flex items-start gap-2 text-gray-700">
                                                <span className="text-blue-600 mt-1">‚úì</span>
                                                <span>{point}</span>
                                            </li>
                                        ))}
                                    </ul>
                                </div>

                                <div className="bg-red-50 border-l-4 border-red-500 p-6 rounded-lg">
                                    <h3 className="text-xl font-bold text-red-700 mb-2">{t.warningTitle}</h3>
                                    <p className="text-gray-800">{t.warningText}</p>
                                </div>
                            </div>

                            <button
                                onClick={startGame}
                                className="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-4 rounded-xl font-bold text-xl hover:scale-105 transition-transform shadow-lg"
                            >
                                {t.startGame}
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-cyan-600 p-4 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-8">
                            <div className="flex justify-between items-start mb-4">
                                <div className="flex-1"></div>
                                <div className="flex-1 text-center">
                                    <h1 className="text-4xl md:text-5xl font-bold text-white mb-2">{t.title}</h1>
                                    <p className="text-blue-100 text-lg">{t.subtitle}</p>
                                </div>
                                <div className="flex-1 flex justify-end">
                                    <button
                                        onClick={() => setLanguage(language === 'en' ? 'fr' : 'en')}
                                        className="bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-colors flex items-center gap-2"
                                    >
                                        <Languages className="w-5 h-5" />
                                        {language === 'en' ? 'FR' : 'EN'}
                                    </button>
                                </div>
                            </div>

                            <div className="flex justify-center gap-6 text-white text-sm md:text-base flex-wrap">
                                <button
                                    onClick={() => setShowInstructionsModal(true)}
                                    className="flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg hover:bg-white/30 transition-colors"
                                >
                                    {t.showInstructions}
                                </button>
                                <div className="flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg">
                                    <Clock className="w-5 h-5" />
                                    <span className="font-semibold">{timeLeft}s</span>
                                </div>
                                <div className="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg">
                                    <span className="font-semibold">{t.challenge} {currentChallenge + 1} {t.of} {currentChallenges.length}</span>
                                </div>
                                <div className="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg">
                                    <span className="font-semibold">{t.score} {score}</span>
                                </div>
                                <div className="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg">
                                    <span className="font-semibold">{t.attempts} {attempts}</span>
                                </div>
                            </div>
                        </div>

                        {showInstructionsModal && (
                            <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50" onClick={() => setShowInstructionsModal(false)}>
                                <div className="bg-white rounded-xl p-6 max-w-2xl max-h-[80vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">{t.howToPlay}</h2>
                                    <ol className="space-y-3 mb-6">
                                        {t.instructions.map((instruction, index) => (
                                            <li key={index} className="flex gap-3">
                                                <span className="flex-shrink-0 w-7 h-7 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-sm">
                                                    {index + 1}
                                                </span>
                                                <span className="text-gray-700 pt-0.5">{instruction}</span>
                                            </li>
                                        ))}
                                    </ol>
                                    <button
                                        onClick={() => setShowInstructionsModal(false)}
                                        className="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors"
                                    >
                                        {t.backToGame}
                                    </button>
                                </div>
                            </div>
                        )}

                        <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 space-y-6">
                            {gameState === 'playing' && (
                                <>
                                    <div className="space-y-4">
                                        <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-red-700 mb-1">{t.badPromptLabel}</p>
                                            <p className="text-gray-700 italic">"{challenge.badPrompt}"</p>
                                        </div>

                                        <div className="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-orange-700 mb-1">{t.poorResultLabel}</p>
                                            <p className="text-gray-700">{challenge.poorResult}</p>
                                        </div>

                                        <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-green-700 mb-2">{t.yourGoalLabel}</p>
                                            <p className="text-gray-800 font-medium">{challenge.goal}</p>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-gray-700 font-semibold mb-2">{t.yourPromptLabel}</label>
                                        <textarea
                                            value={userPrompt}
                                            onChange={(e) => setUserPrompt(e.target.value)}
                                            placeholder={t.promptPlaceholder}
                                            className="w-full h-32 p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none resize-none"
                                            disabled={isLoading}
                                        />
                                    </div>

                                    <div className="flex gap-4">
                                        <button
                                            onClick={testPrompt}
                                            disabled={isLoading || !userPrompt.trim()}
                                            className="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:scale-105 transition-transform disabled:opacity-50 disabled:cursor-not-allowed"
                                        >
                                            {isLoading ? t.testing : t.submitButton}
                                        </button>
                                        <button
                                            onClick={() => setShowHint(!showHint)}
                                            className="bg-yellow-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-yellow-600 transition-colors"
                                        >
                                            {t.hintButton}
                                        </button>
                                    </div>

                                    {showHint && (
                                        <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-yellow-700 mb-1">{t.hint}</p>
                                            <p className="text-gray-700">{challenge.hint}</p>
                                        </div>
                                    )}

                                    {aiResponse && (
                                        <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-blue-700 mb-2">{t.aiResponse}</p>
                                            <p className="text-gray-700 whitespace-pre-wrap">{aiResponse}</p>
                                        </div>
                                    )}
                                </>
                            )}

                            {gameState === 'success' && (
                                <div className="space-y-6">
                                    {aiResponse && (
                                        <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                            <p className="text-sm font-semibold text-blue-700 mb-2">{t.aiResponse}</p>
                                            <p className="text-gray-700 whitespace-pre-wrap">{aiResponse}</p>
                                        </div>
                                    )}
                                    
                                    <div className="text-center py-6">
                                        <div className="text-6xl mb-4">üéâ</div>
                                        <h2 className="text-3xl font-bold text-green-600 mb-4">{t.success}</h2>
                                        <p className="text-gray-700 mb-6">{t.successMessage}</p>
                                        <p className="text-lg mb-6">
                                            <span className="font-semibold">{t.score}</span> <span className="text-2xl text-purple-600 font-bold">+{Math.max(10 - attempts + 1, 1)}</span>
                                        </p>
                                        <button
                                            onClick={nextChallenge}
                                            className="bg-gradient-to-r from-green-600 to-blue-600 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:scale-105 transition-transform"
                                        >
                                            {t.nextChallenge}
                                        </button>
                                    </div>
                                </div>
                            )}

                            {gameState === 'timeup' && (
                                <div className="text-center py-8">
                                    <div className="text-6xl mb-4">‚è∞</div>
                                    <h2 className="text-3xl font-bold text-orange-600 mb-4">{t.timeUp}</h2>
                                    <p className="text-gray-700 mb-6">{t.timeUpMessage}</p>
                                    {currentChallenge < currentChallenges.length - 1 ? (
                                        <button
                                            onClick={nextChallenge}
                                            className="bg-gradient-to-r from-orange-600 to-red-600 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:scale-105 transition-transform"
                                        >
                                            {t.nextChallenge}
                                        </button>
                                    ) : (
                                        <button
                                            onClick={() => setGameState('finished')}
                                            className="bg-gradient-to-r from-orange-600 to-red-600 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:scale-105 transition-transform"
                                        >
                                            {t.finalScore}
                                        </button>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PromptRepairGame />, document.getElementById('root'));
    </script>
</body>
</html>
